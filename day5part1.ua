P ← &fras "day5.txt"

A ← ⊏0:⊃↘↙1

B ← (
  ⊙(⊏0.+×[0 1]↻1.:⍥A2);
  ⊙+:⊙(⍉⊙[;,]⊃≡⊂∘)[0∘]¯⊃-∘
  ♭⊟⊃/>/≤
  /↧↙2↻1
  ⊃∘⊏
)

C ← ⍥(;:;⍢B(=0)0⊙(⊂:):⇌[1.].⊙(°□⊡0_0.↻1))7

⊜⋕∊,+@0⇡10°□A↘1⊜□¬∊,":"P
∵(□↯[:3∘]÷3⧻.⊜⋕∊,+@0⇡10°□):
°↻1↯[:1∘]⧻.
⍥(⊂⊙(C:⊙A)):⊙(⧻,)[]
;:;:/↧
